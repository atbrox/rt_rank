originally based on https://sites.google.com/site/rtranking/